{"version":3,"file":"r3_template_transform.js","sourceRoot":"","sources":["../../../../../packages/compiler/src/render3/r3_template_transform.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {ParsedEvent, ParsedProperty, ParsedVariable, ParserError} from '../expression_parser/ast';\nimport * as html from '../ml_parser/ast';\nimport {replaceNgsp} from '../ml_parser/html_whitespaces';\nimport {isNgTemplate} from '../ml_parser/tags';\nimport {ParseError, ParseErrorLevel, ParseSourceSpan} from '../parse_util';\nimport {isStyleUrlResolvable} from '../style_url_resolver';\nimport {BindingParser} from '../template_parser/binding_parser';\nimport {PreparsedElementType, preparseElement} from '../template_parser/template_preparser';\nimport {syntaxError} from '../util';\nimport * as t from './r3_ast';\n\n\nconst BIND_NAME_REGEXP =\n    /^(?:(?:(?:(bind-)|(let-)|(ref-|#)|(on-)|(bindon-)|(@))(.+))|\\[\\(([^\\)]+)\\)\\]|\\[([^\\]]+)\\]|\\(([^\\)]+)\\))$/;\n\n// Group 1 = \"bind-\"\nconst KW_BIND_IDX = 1;\n// Group 2 = \"let-\"\nconst KW_LET_IDX = 2;\n// Group 3 = \"ref-/#\"\nconst KW_REF_IDX = 3;\n// Group 4 = \"on-\"\nconst KW_ON_IDX = 4;\n// Group 5 = \"bindon-\"\nconst KW_BINDON_IDX = 5;\n// Group 6 = \"@\"\nconst KW_AT_IDX = 6;\n// Group 7 = the identifier after \"bind-\", \"let-\", \"ref-/#\", \"on-\", \"bindon-\" or \"@\"\nconst IDENT_KW_IDX = 7;\n// Group 8 = identifier inside [()]\nconst IDENT_BANANA_BOX_IDX = 8;\n// Group 9 = identifier inside []\nconst IDENT_PROPERTY_IDX = 9;\n// Group 10 = identifier inside ()\nconst IDENT_EVENT_IDX = 10;\n\nconst TEMPLATE_ATTR_PREFIX = '*';\nconst CLASS_ATTR = 'class';\n// Default selector used by `<ng-content>` if none specified\nconst DEFAULT_CONTENT_SELECTOR = '*';\n\n// Result of the html AST to Ivy AST transformation\nexport type Render3ParseResult = {\n  nodes: t.Node[]; errors: ParseError[];\n  // Any non default (empty or '*') selector found in the template\n  ngContentSelectors: string[];\n  // Wether the template contains any `<ng-content>`\n  hasNgContent: boolean;\n};\n\nexport function htmlAstToRender3Ast(\n    htmlNodes: html.Node[], bindingParser: BindingParser): Render3ParseResult {\n  const transformer = new HtmlAstToIvyAst(bindingParser);\n  const ivyNodes = html.visitAll(transformer, htmlNodes);\n\n  // Errors might originate in either the binding parser or the html to ivy transformer\n  const allErrors = bindingParser.errors.concat(transformer.errors);\n  const errors: ParseError[] = allErrors.filter(e => e.level === ParseErrorLevel.ERROR);\n\n  if (errors.length > 0) {\n    const errorString = errors.join('\\n');\n    throw syntaxError(`Template parse errors:\\n${errorString}`, errors);\n  }\n\n  return {\n    nodes: ivyNodes,\n    errors: allErrors,\n    ngContentSelectors: transformer.ngContentSelectors,\n    hasNgContent: transformer.hasNgContent,\n  };\n}\n\nclass HtmlAstToIvyAst implements html.Visitor {\n  errors: ParseError[] = [];\n  // Selectors for the `ng-content` tags. Only non `*` selectors are recorded here\n  ngContentSelectors: string[] = [];\n  // Any `<ng-content>` in the template ?\n  hasNgContent = false;\n\n  constructor(private bindingParser: BindingParser) {}\n\n  // HTML visitor\n  visitElement(element: html.Element): t.Node|null {\n    const preparsedElement = preparseElement(element);\n    if (preparsedElement.type === PreparsedElementType.SCRIPT ||\n        preparsedElement.type === PreparsedElementType.STYLE) {\n      // Skipping <script> for security reasons\n      // Skipping <style> as we already processed them\n      // in the StyleCompiler\n      return null;\n    }\n    if (preparsedElement.type === PreparsedElementType.STYLESHEET &&\n        isStyleUrlResolvable(preparsedElement.hrefAttr)) {\n      // Skipping stylesheets with either relative urls or package scheme as we already processed\n      // them in the StyleCompiler\n      return null;\n    }\n\n    // Whether the element is a `<ng-template>`\n    const isTemplateElement = isNgTemplate(element.name);\n\n    const matchableAttributes: [string, string][] = [];\n    const parsedProperties: ParsedProperty[] = [];\n    const boundEvents: t.BoundEvent[] = [];\n    const variables: t.Variable[] = [];\n    const references: t.Reference[] = [];\n    const attributes: t.TextAttribute[] = [];\n\n    const templateMatchableAttributes: [string, string][] = [];\n    let inlineTemplateSourceSpan: ParseSourceSpan;\n    const templateParsedProperties: ParsedProperty[] = [];\n    const templateVariables: t.Variable[] = [];\n\n    // Whether the element has any *-attribute\n    let elementHasInlineTemplate = false;\n\n    for (const attribute of element.attrs) {\n      let hasBinding = false;\n      const normalizedName = normalizeAttributeName(attribute.name);\n\n      // `*attr` defines template bindings\n      let isTemplateBinding = false;\n\n      if (normalizedName.startsWith(TEMPLATE_ATTR_PREFIX)) {\n        if (elementHasInlineTemplate) {\n          this.reportError(\n              `Can't have multiple template bindings on one element. Use only one attribute prefixed with *`,\n              attribute.sourceSpan);\n        }\n        isTemplateBinding = true;\n        elementHasInlineTemplate = true;\n        const templateValue = attribute.value;\n        const templateKey = normalizedName.substring(TEMPLATE_ATTR_PREFIX.length);\n\n        inlineTemplateSourceSpan = attribute.valueSpan || attribute.sourceSpan;\n\n        const parsedVariables: ParsedVariable[] = [];\n        this.bindingParser.parseInlineTemplateBinding(\n            templateKey, templateValue, attribute.sourceSpan, templateMatchableAttributes,\n            templateParsedProperties, parsedVariables);\n        templateVariables.push(\n            ...parsedVariables.map(v => new t.Variable(v.name, v.value, v.sourceSpan)));\n      } else {\n        // Check for variables, events, property bindings, interpolation\n        hasBinding = this.parseAttribute(\n            isTemplateElement, attribute, matchableAttributes, parsedProperties, boundEvents,\n            variables, references);\n      }\n\n      if (!hasBinding && !isTemplateBinding) {\n        // don't include the bindings as attributes as well in the AST\n        attributes.push(this.visitAttribute(attribute) as t.TextAttribute);\n        matchableAttributes.push([attribute.name, attribute.value]);\n      }\n    }\n\n    const children: t.Node[] =\n        html.visitAll(preparsedElement.nonBindable ? NON_BINDABLE_VISITOR : this, element.children);\n\n    let parsedElement: t.Node|undefined;\n    if (preparsedElement.type === PreparsedElementType.NG_CONTENT) {\n      // `<ng-content>`\n      this.hasNgContent = true;\n\n      if (element.children && !element.children.every(isEmptyTextNode)) {\n        this.reportError(`<ng-content> element cannot have content.`, element.sourceSpan);\n      }\n\n      const selector = preparsedElement.selectAttr;\n\n      let attributes: t.TextAttribute[] = element.attrs.map(attribute => {\n        return new t.TextAttribute(\n            attribute.name, attribute.value, attribute.sourceSpan, attribute.valueSpan);\n      });\n\n      const selectorIndex =\n          selector === DEFAULT_CONTENT_SELECTOR ? 0 : this.ngContentSelectors.push(selector);\n      parsedElement = new t.Content(selectorIndex, attributes, element.sourceSpan);\n    } else if (isTemplateElement) {\n      // `<ng-template>`\n      const boundAttributes = this.createBoundAttributes(element.name, parsedProperties);\n      parsedElement = new t.Template(\n          attributes, boundAttributes, children, references, variables, element.sourceSpan,\n          element.startSourceSpan, element.endSourceSpan);\n    } else {\n      const boundAttributes = this.createBoundAttributes(element.name, parsedProperties);\n\n      parsedElement = new t.Element(\n          element.name, attributes, boundAttributes, boundEvents, children, references,\n          element.sourceSpan, element.startSourceSpan, element.endSourceSpan);\n    }\n\n    if (elementHasInlineTemplate) {\n      const attributes: t.TextAttribute[] = [];\n\n      templateMatchableAttributes.forEach(\n          ([name, value]) =>\n              attributes.push(new t.TextAttribute(name, value, inlineTemplateSourceSpan)));\n\n      const boundAttributes = this.createBoundAttributes('ng-template', templateParsedProperties);\n      parsedElement = new t.Template(\n          attributes, boundAttributes, [parsedElement], [], templateVariables, element.sourceSpan,\n          element.startSourceSpan, element.endSourceSpan);\n    }\n    return parsedElement;\n  }\n\n  visitAttribute(attribute: html.Attribute): t.Node {\n    return new t.TextAttribute(\n        attribute.name, attribute.value, attribute.sourceSpan, attribute.valueSpan);\n  }\n\n  visitText(text: html.Text): t.Node {\n    const valueNoNgsp = replaceNgsp(text.value);\n    const expr = this.bindingParser.parseInterpolation(valueNoNgsp, text.sourceSpan);\n    return expr ? new t.BoundText(expr, text.sourceSpan) : new t.Text(valueNoNgsp, text.sourceSpan);\n  }\n\n  visitComment(comment: html.Comment): null { return null; }\n\n  visitExpansion(expansion: html.Expansion): null { return null; }\n\n  visitExpansionCase(expansionCase: html.ExpansionCase): null { return null; }\n\n  private createBoundAttributes(elementName: string, properties: ParsedProperty[]):\n      t.BoundAttribute[] {\n    return properties.filter(prop => !prop.isLiteral)\n        .map(prop => this.bindingParser.createBoundElementProperty(elementName, prop))\n        .map(prop => t.BoundAttribute.fromBoundElementProperty(prop));\n  }\n\n  private parseAttribute(\n      isTemplateElement: boolean, attribute: html.Attribute, matchableAttributes: string[][],\n      parsedProperties: ParsedProperty[], boundEvents: t.BoundEvent[], variables: t.Variable[],\n      references: t.Reference[]) {\n    const name = normalizeAttributeName(attribute.name);\n    const value = attribute.value;\n    const srcSpan = attribute.sourceSpan;\n\n    const bindParts = name.match(BIND_NAME_REGEXP);\n    let hasBinding = false;\n\n    if (bindParts) {\n      hasBinding = true;\n      if (bindParts[KW_BIND_IDX] != null) {\n        this.bindingParser.parsePropertyBinding(\n            bindParts[IDENT_KW_IDX], value, false, srcSpan, matchableAttributes, parsedProperties);\n\n      } else if (bindParts[KW_LET_IDX]) {\n        if (isTemplateElement) {\n          const identifier = bindParts[IDENT_KW_IDX];\n          this.parseVariable(identifier, value, srcSpan, variables);\n        } else {\n          this.reportError(`\"let-\" is only supported on ng-template elements.`, srcSpan);\n        }\n\n      } else if (bindParts[KW_REF_IDX]) {\n        const identifier = bindParts[IDENT_KW_IDX];\n        this.parseReference(identifier, value, srcSpan, references);\n\n      } else if (bindParts[KW_ON_IDX]) {\n        const events: ParsedEvent[] = [];\n        this.bindingParser.parseEvent(\n            bindParts[IDENT_KW_IDX], value, srcSpan, matchableAttributes, events);\n        addEvents(events, boundEvents);\n      } else if (bindParts[KW_BINDON_IDX]) {\n        this.bindingParser.parsePropertyBinding(\n            bindParts[IDENT_KW_IDX], value, false, srcSpan, matchableAttributes, parsedProperties);\n        this.parseAssignmentEvent(\n            bindParts[IDENT_KW_IDX], value, srcSpan, matchableAttributes, boundEvents);\n      } else if (bindParts[KW_AT_IDX]) {\n        this.bindingParser.parseLiteralAttr(\n            name, value, srcSpan, matchableAttributes, parsedProperties);\n\n      } else if (bindParts[IDENT_BANANA_BOX_IDX]) {\n        this.bindingParser.parsePropertyBinding(\n            bindParts[IDENT_BANANA_BOX_IDX], value, false, srcSpan, matchableAttributes,\n            parsedProperties);\n        this.parseAssignmentEvent(\n            bindParts[IDENT_BANANA_BOX_IDX], value, srcSpan, matchableAttributes, boundEvents);\n\n      } else if (bindParts[IDENT_PROPERTY_IDX]) {\n        this.bindingParser.parsePropertyBinding(\n            bindParts[IDENT_PROPERTY_IDX], value, false, srcSpan, matchableAttributes,\n            parsedProperties);\n\n      } else if (bindParts[IDENT_EVENT_IDX]) {\n        const events: ParsedEvent[] = [];\n        this.bindingParser.parseEvent(\n            bindParts[IDENT_EVENT_IDX], value, srcSpan, matchableAttributes, events);\n        addEvents(events, boundEvents);\n      }\n    } else {\n      hasBinding = this.bindingParser.parsePropertyInterpolation(\n          name, value, srcSpan, matchableAttributes, parsedProperties);\n    }\n\n    return hasBinding;\n  }\n\n  private parseVariable(\n      identifier: string, value: string, sourceSpan: ParseSourceSpan, variables: t.Variable[]) {\n    if (identifier.indexOf('-') > -1) {\n      this.reportError(`\"-\" is not allowed in variable names`, sourceSpan);\n    }\n    variables.push(new t.Variable(identifier, value, sourceSpan));\n  }\n\n  private parseReference(\n      identifier: string, value: string, sourceSpan: ParseSourceSpan, references: t.Reference[]) {\n    if (identifier.indexOf('-') > -1) {\n      this.reportError(`\"-\" is not allowed in reference names`, sourceSpan);\n    }\n\n    references.push(new t.Reference(identifier, value, sourceSpan));\n  }\n\n  private parseAssignmentEvent(\n      name: string, expression: string, sourceSpan: ParseSourceSpan,\n      targetMatchableAttrs: string[][], boundEvents: t.BoundEvent[]) {\n    const events: ParsedEvent[] = [];\n    this.bindingParser.parseEvent(\n        `${name}Change`, `${expression}=$event`, sourceSpan, targetMatchableAttrs, events);\n    addEvents(events, boundEvents);\n  }\n\n  private reportError(\n      message: string, sourceSpan: ParseSourceSpan,\n      level: ParseErrorLevel = ParseErrorLevel.ERROR) {\n    this.errors.push(new ParseError(sourceSpan, message, level));\n  }\n}\n\nclass NonBindableVisitor implements html.Visitor {\n  visitElement(ast: html.Element): t.Element|null {\n    const preparsedElement = preparseElement(ast);\n    if (preparsedElement.type === PreparsedElementType.SCRIPT ||\n        preparsedElement.type === PreparsedElementType.STYLE ||\n        preparsedElement.type === PreparsedElementType.STYLESHEET) {\n      // Skipping <script> for security reasons\n      // Skipping <style> and stylesheets as we already processed them\n      // in the StyleCompiler\n      return null;\n    }\n\n    const children: t.Node[] = html.visitAll(this, ast.children, null);\n    return new t.Element(\n        ast.name, html.visitAll(this, ast.attrs) as t.TextAttribute[],\n        /* inputs */[], /* outputs */[], children,  /* references */[], ast.sourceSpan,\n        ast.startSourceSpan, ast.endSourceSpan);\n  }\n\n  visitComment(comment: html.Comment): any { return null; }\n\n  visitAttribute(attribute: html.Attribute): t.TextAttribute {\n    return new t.TextAttribute(attribute.name, attribute.value, attribute.sourceSpan);\n  }\n\n  visitText(text: html.Text): t.Text { return new t.Text(text.value, text.sourceSpan); }\n\n  visitExpansion(expansion: html.Expansion): any { return null; }\n\n  visitExpansionCase(expansionCase: html.ExpansionCase): any { return null; }\n}\n\nconst NON_BINDABLE_VISITOR = new NonBindableVisitor();\n\nfunction normalizeAttributeName(attrName: string): string {\n  return /^data-/i.test(attrName) ? attrName.substring(5) : attrName;\n}\n\nfunction addEvents(events: ParsedEvent[], boundEvents: t.BoundEvent[]) {\n  boundEvents.push(...events.map(e => t.BoundEvent.fromParsedEvent(e)));\n}\n\nfunction isEmptyTextNode(node: html.Node): boolean {\n  return node instanceof html.Text && node.value.trim().length == 0;\n}\n"]}